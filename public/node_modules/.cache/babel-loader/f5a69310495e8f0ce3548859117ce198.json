{"ast":null,"code":"\"use strict\";\n/**\n * Created by hustcc on 18/5/20.\n * Contract: i@hust.cc\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar SEC_ARRAY = [60, 60, 24, 7, 365 / 7 / 12, 12];\n/**\n * format Date / string / timestamp to Date instance.\n * @param input\n * @returns {*}\n */\n\nfunction toDate(input) {\n  if (input instanceof Date) return +input; // @ts-ignore\n\n  if (!isNaN(input) || /^\\d+$/.test(input)) return +new Date(parseInt(input));\n  input = (input || '' // @ts-ignore\n  ).trim().replace(/\\.\\d+/, '') // remove milliseconds\n  .replace(/-/, '/').replace(/-/, '/').replace(/(\\d)T(\\d)/, '$1 $2').replace(/Z/, ' UTC') // 2017-2-5T3:57:52Z -> 2017-2-5 3:57:52UTC\n  .replace(/([+-]\\d\\d):?(\\d\\d)/, ' $1$2'); // -04:00 -> -0400\n\n  return +new Date(input);\n}\n\nexports.toDate = toDate;\n/**\n * format the diff second to *** time ago, with setting locale\n * @param diff\n * @param localeFunc\n * @returns\n */\n\nfunction formatDiff(diff, localeFunc) {\n  // if locale is not exist, use defaultLocale.\n  // if defaultLocale is not exist, use build-in `en`.\n  // be sure of no error when locale is not exist.\n  var agoIn = diff < 0 ? 1 : 0; // time in or time ago\n\n  diff = Math.abs(diff);\n  var totalSec = diff;\n  var idx = 0;\n\n  for (; diff >= SEC_ARRAY[idx] && idx < SEC_ARRAY.length; idx++) {\n    diff /= SEC_ARRAY[idx];\n  }\n\n  diff = ~~diff;\n  idx *= 2;\n  if (diff > (idx === 0 ? 9 : 1)) idx += 1; // @ts-ignore\n\n  return localeFunc(diff, idx, totalSec)[agoIn].replace('%s', diff);\n}\n\nexports.formatDiff = formatDiff;\n/**\n * calculate the diff second between date to be formatted an now date.\n * @param date\n * @param relativeDate\n * @returns\n */\n\nfunction diffSec(date, relativeDate) {\n  relativeDate = relativeDate ? toDate(relativeDate) : +new Date();\n  return (relativeDate - toDate(date)) / 1000;\n}\n\nexports.diffSec = diffSec;\n/**\n * nextInterval: calculate the next interval time.\n * - diff: the diff sec between now and date to be formatted.\n *\n * What's the meaning?\n * diff = 61 then return 59\n * diff = 3601 (an hour + 1 second), then return 3599\n * make the interval with high performance.\n **/\n\nfunction nextInterval(diff) {\n  var rst = 1,\n      i = 0,\n      d = Math.abs(diff);\n\n  for (; diff >= SEC_ARRAY[i] && i < SEC_ARRAY.length; i++) {\n    diff /= SEC_ARRAY[i];\n    rst *= SEC_ARRAY[i];\n  }\n\n  d = d % rst;\n  d = d ? rst - d : rst; // Math.ceil\n\n  return ~~d;\n}\n\nexports.nextInterval = nextInterval;","map":{"version":3,"mappings":"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","names":["SEC_ARRAY","toDate","input","Date","isNaN","test","parseInt","trim","replace","exports","formatDiff","diff","localeFunc","agoIn","Math","abs","totalSec","idx","length","diffSec","date","relativeDate","nextInterval","rst","i","d"],"sources":["utils/date.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}